<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<title>Pavan Kalyan's Blog | Understanding the different kinds of keys used in databases</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<meta property="og:title" content="Understanding the different kinds of keys used in databases">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://pavan-kalyan.dev/posts/understanding-the-different-kinds-of-keys-available-in-databases">
	<meta property="og:description" content="">
	<meta property="og:site_name" content="Pavan Kalyan's Blog">

	<meta name="twitter:card" content="summary">
	<meta name="twitter:url" content="https://pavan-kalyan.dev/posts/understanding-the-different-kinds-of-keys-available-in-databases">
	<meta name="twitter:title" content="Understanding the different kinds of keys used in databases">
	<meta name="twitter:description" content="">

	
	<meta property="og:image" content="https://pavan-kalyan.dev/assets/og-image-ee46bbc61b334e821e81534b1fd43f3fee6f020ec174b3c2114445695fd48c01.jpg">
	<meta name="twitter:image" content="https://pavan-kalyan.dev/assets/og-image-ee46bbc61b334e821e81534b1fd43f3fee6f020ec174b3c2114445695fd48c01.jpg">
	

	<link href="https://pavan-kalyan.dev/feed.xml" type="application/rss+xml" rel="alternate" title="Pavan Kalyan's Blog Last 10 blog posts" />

	
	<link rel="stylesheet" type="text/css" href="/assets/fonts-d3e0f161d4de5765d4bcd9df3bfa83599d907ee9667d5148371c2af24f725559.css">
	

	

	
	<link rel="stylesheet" type="text/css" title="light" id="light" href="/assets/light-ebe4700bfdbf6a2473d76231d2f0dc5b8e8a3ca56a2bc42baa20641c1ef8ede5.css">
	<link rel="stylesheet" type="text/css" title="dark" id="dark" href="/assets/dark-28a53529149b36ea483bc030c7284596de2cedbca4690407eb0fc3262a5d5ebb.css" disabled="true">
	

	
	<script src="https://cdn.jsdelivr.net/npm/algoliasearch@4"></script>
	<script src="https://cdn.jsdelivr.net/npm/instantsearch.js@4"></script>


	<!-- Goat Counter - webpage counter -->
	<script data-goatcounter="https://pavan-kalyan.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>
	 <!-- /Goat Counter -->

</head>

<body>
  <main>
    <div class="grid grid-centered">
      <div class="grid-cell">
        <nav class="header-nav ">
  <a href="/" class="header-logo" title="Pavan Kalyan's Blog">Pavan Kalyan's Blog</a>
  <ul class="header-links">
    
    
    
      <li>
        <a href="https://medium.com/@damalapati.pavan" rel="noreferrer noopener" target="_blank" title="Medium">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-medium">
  <use href="/assets/medium-c490b76e2e7329f77cc2df18acc17452868ea861ed0e1ecf621c9777877068f5.svg#icon-medium" xlink:href="/assets/medium-c490b76e2e7329f77cc2df18acc17452868ea861ed0e1ecf621c9777877068f5.svg#icon-medium"></use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a href="https://github.com/pavan-kalyan" rel="noreferrer noopener" target="_blank" title="GitHub">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-github">
  <use href="/assets/github-094f81040819f34343ee6ffff0980f17e2807b08b595eaaf66ae3554934fd78d.svg#icon-github" xlink:href="/assets/github-094f81040819f34343ee6ffff0980f17e2807b08b595eaaf66ae3554934fd78d.svg#icon-github"></use>
</svg>

        </a>
      </li>
    
    
    
    
      <li>
        <a href="https://stackoverflow.com/users/7470050" rel="noreferrer noopener" target="_blank" title="Stack Overflow">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-stackoverflow">
  <use href="/assets/stackoverflow-12ba59133ed134d26156d30f095e0222b6039395cf26f2fab0cb6ce3ef2db00d.svg#icon-stackoverflow" xlink:href="/assets/stackoverflow-12ba59133ed134d26156d30f095e0222b6039395cf26f2fab0cb6ce3ef2db00d.svg#icon-stackoverflow"></use>
</svg>

        </a>
      </li>
    
    
    
    
      <li>
        <a href="https://www.linkedin.com/in/pavan-kalyan-damalapati" rel="noreferrer noopener" target="_blank" title="LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-linkedin">
  <use href="/assets/linkedin-cdc5c107044324a3dfbea2e9ead15873f8dee304c37d73a046988956b706256e.svg#icon-linkedin" xlink:href="/assets/linkedin-cdc5c107044324a3dfbea2e9ead15873f8dee304c37d73a046988956b706256e.svg#icon-linkedin"></use>
</svg>

        </a>
      </li>
    
    
    
    
    
    
    
    
    
    
    
    
    
      <li>
        <a href="mailto:damalapati.pavan@gmail.com" title="Email">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-email">
  <use href="/assets/email-782473193bf750036fdb90e8daa075508a20509d01854c09f3237c144a3f0601.svg#icon-email" xlink:href="/assets/email-782473193bf750036fdb90e8daa075508a20509d01854c09f3237c144a3f0601.svg#icon-email"></use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a href="/feed.xml" rel="noreferrer noopener" target="_blank" title="RSS">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-rss">
  <use href="/assets/rss-541ec5cea9cefd10d2fcfec01888f3f231a8829940249835fa7b7b3a12ae0d0d.svg#icon-rss" xlink:href="/assets/rss-541ec5cea9cefd10d2fcfec01888f3f231a8829940249835fa7b7b3a12ae0d0d.svg#icon-rss"></use>
</svg>

        </a>
      </li>
    
    
      <li>
        <a onclick="toggle()" title="Toggle Theme">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon-theme">
  <use href="/assets/theme-66869e0bf8dab34bae1c86bda400327b772e0be69e8dc28d3ede896e771320ed.svg#icon-theme" xlink:href="/assets/theme-66869e0bf8dab34bae1c86bda400327b772e0be69e8dc28d3ede896e771320ed.svg#icon-theme"></use>
</svg>

        </a>
      </li>
    
  </ul>

<nav>
  <ul class="header-sub ">
    
      <li><a href="/">Blog</a></li>
    
    
      <li>
        <a href="/about/" title="About me">About</a>
      </li>
    
    <li><a href="/research/">Research</a></li>
    <li><a href="/projects/">Projects</a></li>
    <li><a href="/publications/">Publications</a></li>
	<li><a href="/search/">Search <svg xmlns="http://www.w3.org/2000/svg" class="icon-search" width="16px" height="16px" viewBox="0 -15 60 60">
  <use href="/assets/search-9b1695702dbef55e657e06d698cfb2a10bd329e1e4b5827a8faeba06db0de0a9.svg#icon-search" xlink:href="/assets/search-9b1695702dbef55e657e06d698cfb2a10bd329e1e4b5827a8faeba06db0de0a9.svg#icon-search"></use>
</svg>
</a></li>
  </ul>
</nav>

</nav>




        <article class="article ">
          <header class="article-header">
            <h1>Understanding the different kinds of keys used in databases</h1>
            <p></p>
            <div class="article-list-footer">
  <span class="article-list-date">
    May 21, 2022
  </span>
  <span class="article-list-divider">-</span>
  <span class="article-list-minutes">
    
    
      4 minute read
    
  </span>
  <span class="article-list-divider">-</span>
  <div class="article-list-tags">
    
      
      <a href="/tag/db" title="See all posts with tag 'DB'">DB</a>
    
  </div>
</div>
          </header>

          <div class="article-content">
            <p>Working with different kinds of databases and data warehouses can be confusing as they all provide different kinds of keys but they also name the same keys differently.
So, I worked on understanding and categorizing them based on what they do so that I can immediately recognize what X key provided by database Y actually means.</p>

<h2 id="primary-key">Primary Key</h2>
<p>The most commonly used and well-known type of key. A primary key is a column or a set of columns that uniquely identifies a tuple in a relational schema.
One of the core concepts of relational schemas is that each table <strong>must</strong> have its own primary key. It’s almost always automatically indexed.
Usually supported as an auto-incrementing number column. It’s used in all the relational and row-oriented databases like MySQL, PostgreSQL, etc.</p>

<p>The concept of a primary key doesn’t exist in column-oriented databases (typically data warehouses), though they usually have some way of defining unique keys.</p>

<h4 id="difference-between-primary-key-and-unique-key">Difference between Primary key and Unique key</h4>
<p>They are essentially the same in most databases. Both uniquely identify a tuple. “primary key” is the formal terminology used in relational designs. Whereas unique keys are used more for validation on inserts or updates whereas primary key is usually an auto-incrementing key, so it might not be able to validate business context.
One exception to this is that unique keys in some databases ignore null values when determining if a tuple is unique.</p>

<h2 id="foreign-key">Foreign key</h2>
<p>Foreign keys enforce relations between different tables. Usually, a table might have a foreign key referring to another table. This other table is the parent table.
Inserts and updates would be rejected if the corresponding entity does not already exist in the parent table. Similarly, there are different validations that can be defined for inserts, updates, and especially deletes.</p>

<h2 id="partition-key">Partition Key</h2>
<p>Partition keys are used to segment the data into separate files/blocks.
In distributed systems, this usually means storing segments of a table on different machines.
Partitioning randomly is a bad idea for query performance because any query might end up needing to scan all the partitions across all machines.
So, usually partitioning is only allowed on date or time columns.
For example, if we partition monthly, we will be able to only scan the blocks that are actually required instead of the entire thing.
Some warehouses also allow partitioning by varchar columns based on a prefix.</p>

<p>So far so good, but the following keys are where there is little consensus on what to call them.</p>

<h2 id="sort-key">Sort Key</h2>
<p>Sort key defines the list of columns based on which the data is sorted and stored on disk.</p>

<p>The main advantage of sorting the data and storing it on disk is that certain queries would be much faster. Filters, aggregates, and joins would all benefit from this representation. For example, range predicates would allow skipping huge chunks of data because we can prune data that will not fall under the predicate.</p>

<p>This is particularly common in column-oriented databases like Redshift, Firebolt, BigQuery, and Snowflake. Though they are referred to differently in different warehouses. For example, BigQuery refers to sort keys as <strong>clustering keys</strong>, which should not be confused with <strong>cluster keys</strong> (join keys). Similarly, Firebolt calls it <strong>Primary index</strong> which is even more confusing.</p>

<h2 id="join-key">Join key</h2>
<p>Join index is a concept used in databases to specify that data in 2 or more relations should be colocated together on the file system.
Also sometimes called a <strong>cluster key</strong> to represent that the data is physically clustered together. Not to be confused with <strong>clustering key</strong> in BigQuery which is about sorting.</p>

<p>Consider A and B with a common column c. If we set the cluster key as c, records of A with c value that matches records of B with the same c value are stored physically together in the same block. This helps join queries become highly optimized as we automatically perform the join on read. But it comes at the cost that simple queries end up taking more time. i.e, simple <code class="highlighter-rouge">select * from A</code> will have to access a lot more blocks from B just to get records of A.</p>

<p>Firebolt <a href="https://docs.firebolt.io/using-indexes/using-join-indexes.html">supports join indexes</a> by caching the join results in ram in the form of an index rather than storing the data together on disk.</p>

<h2 id="aggregate-key">Aggregate Key</h2>
<p>Set of columns or which we pre-calculate aggregate statistics to serve aggregate queries faster.
Queries like MAX(), MIN(), and COUNT() would benefit from this as a full table scan can be avoided.</p>

<p>Setting an aggregate key can involve also registering an aggregate expression because the index won’t be able to serve everything quickly if the input query is unbounded. For example, changing the aggregate function or widely varying the where clauses would not be served by the existing aggregate index and would default to a table scan. Unlike all the other keys, this is very different as it is essentially, a materialized summary table.</p>

<p>Firebolt calls it Aggregate Index. But the functionality probably can be crudely replicated by using a materialized summary table in the form of a <a href="https://en.wikipedia.org/wiki/OLAP_cube">multi-dimensional cube</a> to support some more aggregate queries rather than the ones purely pre-decided.</p>

<h3 id="references">References</h3>
<ul>
  <li><a href="https://cloud.google.com/bigquery/docs/clustered-tables">https://cloud.google.com/bigquery/docs/clustered-tables</a></li>
  <li><a href="https://en.wikipedia.org/wiki/OLAP_cube">https://en.wikipedia.org/wiki/OLAP_cube</a></li>
  <li><a href="https://docs.firebolt.io/using-indexes/using-join-indexes.html">https://docs.firebolt.io/using-indexes/using-join-indexes.html</a></li>
</ul>


          </div>
	  <!--
          <div class="article-share">
            
            
            <a href="https://twitter.com/home?status=Understanding+the+different+kinds+of+keys+used+in+databases%20-%20https://pavan-kalyan.dev/posts/understanding-the-different-kinds-of-keys-available-in-databases" title="Share on Twitter" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M492 109.5c-17.4 7.7-36 12.9-55.6 15.3 20-12 35.4-31 42.6-53.6 -18.7 11.1-39.4 19.2-61.5 23.5C399.8 75.8 374.6 64 346.8 64c-53.5 0-96.8 43.4-96.8 96.9 0 7.6 0.8 15 2.5 22.1 -80.5-4-151.9-42.6-199.6-101.3 -8.3 14.3-13.1 31-13.1 48.7 0 33.6 17.2 63.3 43.2 80.7C67 210.7 52 206.3 39 199c0 0.4 0 0.8 0 1.2 0 47 33.4 86.1 77.7 95 -8.1 2.2-16.7 3.4-25.5 3.4 -6.2 0-12.3-0.6-18.2-1.8 12.3 38.5 48.1 66.5 90.5 67.3 -33.1 26-74.9 41.5-120.3 41.5 -7.8 0-15.5-0.5-23.1-1.4C62.8 432 113.7 448 168.3 448 346.6 448 444 300.3 444 172.2c0-4.2-0.1-8.4-0.3-12.5C462.6 146 479 129 492 109.5z"/></svg>
            </a>
            <a href="https://www.facebook.com/sharer/sharer.php?u=https://pavan-kalyan.dev/posts/understanding-the-different-kinds-of-keys-available-in-databases" title="Share on Facebook" rel="noreferrer noopener" target="_blank">
              <svg viewBox="0 0 512 512"><path d="M288 192v-38.1c0-17.2 3.8-25.9 30.5-25.9H352V64h-55.9c-68.5 0-91.1 31.4-91.1 85.3V192h-45v64h45v192h83V256h56.4l7.6-64H288z"/></svg>
            </a>
          </div>

	  -->
          
        </article>
        <footer class="footer ">
  <p>
  This is a technical blog, where I write about various things I learn or want to share.
  <br>
    <a href="/about" title="About me">Pavan Kalyan Damalapati</a>
</footer>

      </div>
    </div>
  </main>
  

<script type="text/javascript" src="/assets/vendor-3ee2c63bbac916f96cd7f90e83ab767f058ead1301444c9966f5156911c8be7f.js"></script>





<script type="text/javascript" src="/assets/application-cfde13ac81ddaf4351b2e739603e2baf688d0fcc9aba613fe62bbb1c7b037fb9.js"></script>


  <script type="text/javascript" src="/assets/themetoggle-df0d3d73164dc26dffbd630182ae4d0dfa7bee6b694a2b5d565d73595b582bbf.js"></script>

</body>
</html>
